<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Therapy Room</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
<style>
  body { 
    font-family: 'Montserrat', sans-serif; 
    display: flex; justify-content: center; align-items: center; 
    height: 100vh; margin: 0;
    background: linear-gradient(135deg, #9b59b6, #6a1b9a); 
    flex-direction: row;
    gap: 40px;
  }
  .panel { 
    width: 400px; padding: 35px; border-radius: 20px; 
    background: #fff; text-align: center; 
    box-shadow: 0 10px 30px rgba(0,0,0,0.15);
    animation: fadeIn 0.6s ease;
  }
  h2 { margin-bottom: 20px; font-size: 22px; color: #6a1b9a; font-weight: 600; }
  input, select, button {
    width: 100%; padding: 12px 15px; margin: 12px 0;
    font-size: 15px; border-radius: 10px; border: 1px solid #ccc; 
    outline: none; transition: 0.3s;
  }
  input:focus, select:focus { border-color: #9b59b6; box-shadow: 0 0 5px rgba(155, 89, 182, 0.4); }
  button {
    background: linear-gradient(135deg, #9b59b6, #6a1b9a);
    color: #fff; border: none; cursor: pointer; 
    font-weight: 600; transition: 0.3s;
  }
  button:hover { background: linear-gradient(135deg, #6a1b9a, #9b59b6); transform: translateY(-2px); box-shadow: 0 5px 15px rgba(155, 89, 182, 0.4);}
  a { word-break: break-word; color: #6a1b9a; display: block; margin: 10px 0; font-weight: 500; }

  /* Popup styles */
  #popup {
    position: fixed; top:0; left:0; width:100%; height:100%;
    background: rgba(0,0,0,0.6); display:none; 
    justify-content:center; align-items:center;
  }
  #popup .content {
    background:#fff; padding:30px; border-radius:15px; 
    text-align:center; width:300px; 
    box-shadow: 0 10px 25px rgba(0,0,0,0.2);
    animation: fadeInScale 0.4s ease;
  }
  #popup p { color: #d32f2f; font-weight: 500; margin-bottom: 15px; }
  #popup button { background:#27ae60; color:#fff; }

  @keyframes fadeIn { from { opacity:0; transform: translateY(20px); } to { opacity:1; transform: translateY(0); } }
  @keyframes fadeInScale { from { opacity:0; transform: scale(0.8); } to { opacity:1; transform: scale(1); } }

  /* Ticker */
  .ticker-full {
    position: fixed; top: 0; left: 0; width: 100%;
    overflow: hidden;
    background: linear-gradient(135deg, #079fdb, #040305);
    padding: 12px 0; color: #fff; font-weight: 500; font-size: 15px; z-index: 1000;
  }
  .ticker-full .ticker-content {
    display: inline-block; white-space: nowrap;
    padding-left: 100%; animation: tickerFullAnim 25s linear infinite;
  }
  .ticker-item { display: inline-block; margin-right: 50px; }
  .ticker-item i { margin-right: 6px; color: #ffd700; }
  @keyframes tickerFullAnim { 0% { transform: translateX(0%); } 100% { transform: translateX(-100%); } }

  /* Logo */
  .logo-container { display: flex; justify-content: center; align-items: center; height: 150px; }
  .logo { max-width: 100%; height: 260px; animation: spin 10s linear infinite; }
  @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

  /* Profile */
  .profile-container { display: flex; flex-direction: column; align-items: center; }
  .doctor-box { text-align: center; }
  .doctor-box img { width: 300px; height: 350px; object-fit: cover; border: 3px solid #9b59b6; border-radius: 10px; }
  .doctor-box p { margin-top: 10px; font-size: 18px; font-weight: 600; color: #fff; }

  /* Social */
  .social-icons { margin-top: 15px; display: flex; justify-content: center; gap: 20px; }
  .social-icons a { display: flex; align-items: center; justify-content: center; width: 50px; height: 50px; border-radius: 50%; background: #fff; padding: 5px; transition: 0.3s; }
  .social-icons a img { width: 100%; height: 100%; object-fit: contain; }
  .social-icons a:hover { transform: scale(1.2); box-shadow: 0 5px 15px rgba(155, 89, 182, 0.4); }

  /* Mobile */
  @media (max-width: 768px) {
    body { flex-direction: column; gap: 20px; justify-content: flex-start; align-items: center; }
    .profile-container { order: 1; top: -25px; }
    .panel { width: 90%; padding: 25px; margin-top: 80px; }
    .doctor-box img { width: 80%; height: auto; }
  }
</style>
</head>
<body>
<!-- Full-width Marquee Ticker -->
<div class="ticker-full">
  <div class="ticker-content">
    <span class="ticker-item"><i class="fa-solid fa-brain"></i> Hypnosis – Release fears</span>
    <span class="ticker-item"><i class="fa-solid fa-people-arrows"></i> Couple Counseling – Better bonding</span>
    <span class="ticker-item"><i class="fa-solid fa-moon"></i> Past Life Regression – Heal trauma</span>
    <span class="ticker-item"><i class="fa-solid fa-leaf"></i> Deep Healing – Emotional balance</span>
    <span class="ticker-item"><i class="fa-solid fa-face-meh-blank"></i> Overthinking – Calm mind</span>
  </div>
</div>

<!-- Left Panel -->
<div class="panel">
    <div class="logo-container">
      <img src="LOGO DEAR THERAPIST (1).png" alt="Logo" class="logo" />
    </div>

    <h2>Set Duration & Generate Link</h2>

    <label>Select Duration (Minutes):</label>
    <select id="meetingDuration">
      <option value="5">5 Minute</option>
      <option value="10">10 Minute</option>
      <option value="15">15 Minutes</option>
      <option value="30" selected>30 Minutes</option>
      <option value="60">60 Minutes</option>
      <option value="90">90 Minutes</option>
      <option value="120">120 Minutes</option>
      <option value="180">180 Minutes</option>
    </select>

    <button id="generateLinkBtn">Generate Link</button>

    <div class="link-container" id="linkContainer" style="display:none;">
      <p>Your Meeting Link:</p>
      <a href="#" id="meetingLink" target="_blank"></a>
      <br><br>
      <button id="copyBtn">Copy Link</button>
    </div>
</div>

<!-- Right Panel -->
<div class="profile-container">
  <div class="doctor-box" style="margin-top: 40px;">
    <img src="ts.jpeg" alt="Dr. Shaveta">
    <p>Welcome To Dr. Shaveta Therapy Room</p>
  </div>
  <div class="social-icons" style="margin-top: -10px;">
    <a href="https://instagram.com" target="_blank"><img src="instalogo.png" alt="Instagram"></a>
    <a href="https://youtube.com" target="_blank"><img src="youtube.png" alt="YouTube"></a>
    <a href="https://wa.me/1234567890" target="_blank"><img src="whatsap.png" alt="WhatsApp"></a>
    <a href="https://yourwebsite.com" target="_blank"><img src="web.png" alt="Website"></a>
  </div>
</div>

<!-- Popup -->
<div id="popup">
  <div class="content">
    <p>❌ You already have an active meeting. Please rebook your session.</p>
    <button id="rebookBtn">Rebook</button>
  </div>
</div>

<script>
const BASE = "https://hdigitalpro7.github.io/videomeeting/WEB_UIKITS.html";

// Generate a unique meeting ID every time
function makeUniqueId(len = 12) {
  return 'meet-' + Math.random().toString(36).substring(2, 2 + len);
}

const generateBtn = document.getElementById('generateLinkBtn');
const popup = document.getElementById('popup');
const rebookBtn = document.getElementById('rebookBtn');
const linkContainer = document.getElementById('linkContainer');
const meetingLink = document.getElementById('meetingLink');
const meetingDuration = document.getElementById('meetingDuration');

// Generate new link
function generateLink() {
  const duration = meetingDuration.value;
  const meetingId = makeUniqueId(); // Always a new ID
  const link = `${BASE}?meetingId=${meetingId}&duration=${duration}`;

  // Save only one active meeting — old links expire automatically
  localStorage.setItem("activeMeeting", JSON.stringify({
    id: meetingId,
    duration: duration,
    joined: false
  }));

  meetingLink.href = link;
  meetingLink.textContent = link;
  linkContainer.style.display = 'block';
}

// Button click generates a new link every time
generateBtn.addEventListener('click', generateLink);

// Rebook button generates a fresh new link
rebookBtn.addEventListener('click', () => {
  popup.style.display = 'none';
  generateLink();
});

// Copy link
document.getElementById('copyBtn').addEventListener('click', () => {
  navigator.clipboard.writeText(meetingLink.href);
  alert("✅ Link copied to clipboard!");
});

// WEB_UIKITS.html logic — only allow first-time join
if (window.location.pathname.endsWith("WEB_UIKITS.html")) {
  const params = new URLSearchParams(window.location.search);
  const meetingId = params.get("meetingId");
  const active = JSON.parse(localStorage.getItem("activeMeeting"));

  if (!active || active.id !== meetingId) {
    // Old link or invalid
    window.location.href = "expire.html";
  } else if (active.joined) {
    // Already used
    document.body.innerHTML = "<h2 style='text-align:center;margin-top:50px;color:red;'>❌ This link has already been used. Please rebook your session.</h2>";
  } else {
    // First-time join
    active.joined = true;
    localStorage.setItem("activeMeeting", JSON.stringify(active));
    document.body.innerHTML = `<h2 style='text-align:center;margin-top:50px;color:green;'>✅ Welcome to your session! Duration: ${active.duration} minutes.</h2>`;
  }
}

</script>
</body>
</html>
